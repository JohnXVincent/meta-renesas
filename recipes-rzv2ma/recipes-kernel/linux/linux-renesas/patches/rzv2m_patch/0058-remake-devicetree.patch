From 85ad4dc750c23a3ce87bb340f2a8ce22b92d7e6c Mon Sep 17 00:00:00 2001
From: Canh Dao <canh.dao.ct@renesas.com>
Date: Fri, 15 Apr 2022 17:35:33 +0700
Subject: [PATCH] remake-devicetree

Signed-off-by: Canh Dao <canh.dao.ct@renesas.com>
---
 .../renesas/r9a09g011gbg-evaluation-board.dts | 33 ++-----------------
 arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi | 22 -------------
 drivers/soc/renesas/renesas-soc.c             |  8 ++---
 3 files changed, 6 insertions(+), 57 deletions(-)

diff --git a/arch/arm64/boot/dts/renesas/r9a09g011gbg-evaluation-board.dts b/arch/arm64/boot/dts/renesas/r9a09g011gbg-evaluation-board.dts
index f3a1ddfa8a4d..56e3111aaa8d 100644
--- a/arch/arm64/boot/dts/renesas/r9a09g011gbg-evaluation-board.dts
+++ b/arch/arm64/boot/dts/renesas/r9a09g011gbg-evaluation-board.dts
@@ -12,7 +12,7 @@
 / {
 
     model = "RZ/V2M";
-    compatible = "rdk,rdk", "renesas,r8arzv2m";
+    compatible = "renesas,r9a09g011gbg";
 
     aliases {
         serial0 = &uart0;
@@ -121,15 +121,6 @@ &usb3_peri0 {
     status = "okay";
     renesas,usb-role-switch;
 
-    port {
-        #address-cells = <1>;
-        #size-cells = <0>;
-
-        usb3peri_role_switch: endpoint@0 {
-            reg = <0>;
-            remote-endpoint = <&hd3ss3220_ep>;
-        };
-    };
 };
 
 &pfc {
@@ -155,27 +146,7 @@ slavedev {
 &i2c0 {
     clock-frequency = <100000>;
     status = "okay";
-    hd3ss3220@47 {
-        compatible = "ti,hd3ss3220";
-        reg = <0x47>;
-
-        usb_con: connector {
-            compatible = "usb-c-connector";
-            label = "USB-C";
-            data-role = "dual";
-        };
-
-        port {
-            #address-cells = <1>;
-            #size-cells = <0>;
-
-            hd3ss3220_ep: endpoint@0 {
-                reg = <0>;
-                remote-endpoint = <&usb3peri_role_switch>;
-            };
-        };
-    };
-   clock-generator@68 {
+    clock-generator@68 {
        compatible = "idt,9fgv0241";
        reg = <0x68>;
     };
diff --git a/arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi b/arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi
index 7f3e62089528..0000ad0157e2 100644
--- a/arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi
+++ b/arch/arm64/boot/dts/renesas/r9a09g011gbg.dtsi
@@ -69,27 +69,11 @@ extal_clk: extal {
         /* This value must be overridden by the board */
         clock-frequency = <0>;
     };
-    imclk: imclk@200M {
-        #clock-cells = <0>;
-        compatible = "fixed-clock";
-        clock-frequency = <200000000>;
-    };
     pclk: pclk@100M {
         #clock-cells = <0>;
         compatible = "fixed-clock";
         clock-frequency = <100000000>;
     };
-
-    usbclk: usbclk@200M {
-        #clock-cells = <0>;
-        compatible = "fixed-clock";
-        clock-frequency = <200000000>;
-    };
-    ethclk: ethclk@200M {
-        #clock-cells = <0>;
-        compatible = "fixed-clock";
-        clock-frequency = <200000000>;
-    };
     sys: sys@100M {
         #clock-cells = <0>;
         compatible = "fixed-clock";
@@ -283,7 +267,6 @@ csi0: csi@a4020000 {
             compatible = "renesas,rzv2m-csi";
             reg = <0x00 0xa4020000 0x0 0x80>;
             interrupts = <GIC_SPI 226 IRQ_TYPE_LEVEL_HIGH>;
-            /* clocks = <&cpg CPG_MOD 1508>; */
             clocks = <&csi_clk>;
             #address-cells = <1>;
             #size-cells = <0>;
@@ -296,7 +279,6 @@ csi1: csi@a4020080 {
             compatible = "renesas,rzv2m-csi";
             reg = <0x00 0xa4020080 0x0 0x80>;
             interrupts = <GIC_SPI 227 IRQ_TYPE_LEVEL_HIGH>;
-            /* clocks = <&cpg CPG_MOD 1509>; */
             clocks = <&csi_clk>;
             #address-cells = <1>;
             #size-cells = <0>;
@@ -309,7 +291,6 @@ csi2: csi@a4020100 {
             compatible = "renesas,rzv2m-csi";
             reg = <0x00 0xa4020100 0x0 0x80>;
             interrupts = <GIC_SPI 228 IRQ_TYPE_LEVEL_HIGH>;
-            /* clocks = <&cpg CPG_MOD 1510>; */
             clocks = <&csi_clk>;
             #address-cells = <1>;
             #size-cells = <0>;
@@ -322,7 +303,6 @@ csi3: csi@a4020180 {
             compatible = "renesas,rzv2m-csi";
             reg = <0x00 0xa4020180 0x0 0x80>;
             interrupts = <GIC_SPI 229 IRQ_TYPE_LEVEL_HIGH>;
-            /* clocks = <&cpg CPG_MOD 1511>; */
             clocks = <&csi_clk>;
             #address-cells = <1>;
             #size-cells = <0>;
@@ -335,7 +315,6 @@ csi4: csi@a4020200 {
             compatible = "renesas,rzv2m-csi";
             reg = <0x00 0xa4020200 0x0 0x80>;
             interrupts = <GIC_SPI 230 IRQ_TYPE_LEVEL_HIGH>;
-            /* clocks = <&cpg CPG_MOD 1512>; */
             clocks = <&csi_clk>;
             #address-cells = <1>;
             #size-cells = <0>;
@@ -348,7 +327,6 @@ csi5: csi@a4020280 {
             compatible = "renesas,rzv2m-csi";
             reg = <0x00 0xa4020280 0x0 0x80>;
             interrupts = <GIC_SPI 231 IRQ_TYPE_LEVEL_HIGH>;
-           /* clocks = <&cpg CPG_MOD 1513>; */
             clocks = <&csi_clk>;
             #address-cells = <1>;
             #size-cells = <0>;
diff --git a/drivers/soc/renesas/renesas-soc.c b/drivers/soc/renesas/renesas-soc.c
index 805b807e442b..475d04729861 100644
--- a/drivers/soc/renesas/renesas-soc.c
+++ b/drivers/soc/renesas/renesas-soc.c
@@ -58,7 +58,7 @@ static const struct renesas_family fam_rzg2 __initconst __maybe_unused = {
 };
 
 static const struct renesas_family fam_rzv2 __initconst __maybe_unused = {
-       .name   = "RZ/V2",
+       .name   = "RZ/V2M",
        .reg    = 0xA3F03104,           /* SYS (Version Register) */
 };
 
@@ -285,7 +285,7 @@ static const struct of_device_id renesas_socs[] __initconst = {
 	{ .compatible = "renesas,r8a774e1",	.data = &soc_rz_g2h },
 #endif
 #ifdef CONFIG_ARCH_R9A09G011GBG
-	{ .compatible = "renesas,r8arzv2m",      .data = &soc_rz_v2m },
+	{ .compatible = "renesas,r9a09g011gbg", .data = &soc_rz_v2m },
 #endif
 #ifdef CONFIG_ARCH_R8A7778
 	{ .compatible = "renesas,r8a7778",	.data = &soc_rcar_m1a },
@@ -462,8 +462,8 @@ static int __init renesas_soc_init(void)
 	if (strcmp(soc_dev_attr->family, fam_rzg2ul.name))
 		soc_dev_attr->revision = 0;
 
-	pr_info("Detected Renesas %s %s %s\n", soc_dev_attr->family,
-		soc_dev_attr->soc_id, soc_dev_attr->revision ?: "");
+	pr_info("Detected Renesas %s (%s)\n", soc_dev_attr->family,
+			soc_dev_attr->soc_id ?: "");
 
 	soc_dev = soc_device_register(soc_dev_attr);
 	if (IS_ERR(soc_dev)) {
-- 
2.25.1

